(this["webpackJsonpmini-app"]=this["webpackJsonpmini-app"]||[]).push([[0],{133:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(21),i=n.n(r),a=n(12),s=n.n(a),o=n(26),d=n.n(o),l=n(30),j=n(24),b=n(17),u=n(5),f=(n(131),n(134)),p=n(135),O=n(136),x=n(4),h=function(e){var t=e.id,n=e.go,c=(e.fetchedUser,e.showQRReader),r=e.codeList;return Object(x.jsxs)(u.i,{id:t,children:[Object(x.jsx)(u.j,{children:"QR \u043f\u0440\u0438\u043b\u043e\u0436\u0443\u043b\u044c\u043a\u0430"}),Object(x.jsx)(u.d,{onClick:c,before:Object(x.jsx)(f.a,{}),children:"\u041e\u0442\u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c QR \u043a\u043e\u0434"}),Object(x.jsx)(u.d,{onClick:n,"data-to":"QrList",expandable:!0,before:Object(x.jsx)(p.a,{}),indicator:Object(x.jsx)(u.e,{mode:"primary",children:r.length}),children:"\u0421\u043f\u0438\u0441\u043e\u043a \u043e\u0442\u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 QR \u043a\u043e\u0434\u043e\u0432"}),Object(x.jsx)(u.n,{}),Object(x.jsx)(u.d,{onClick:n,"data-to":"AllowedQrList",expandable:!0,before:Object(x.jsx)(O.a,{}),children:"\u0411\u043e\u043d\u0443\u0441\u043d\u043e\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u0435"})]})},g=(n.p,n(137)),m=function(e){var t,n=e.id,c=e.fetchedUser,r=e.go;return Object(x.jsx)(u.i,{id:n,children:Object(x.jsx)(u.f,{children:Object(x.jsx)(u.l,{icon:Object(x.jsx)(g.a,{}),header:"\u041f\u0440\u0438\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u043c, "+(t=c,(null==t||null==t.first_name?"\u041f\u0440\u0438\u044f\u0442\u0435\u043b\u044c":c.first_name)+"!"),action:Object(x.jsx)(u.c,{size:"m",onClick:r,"data-to":"Home",children:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a QR \u043a\u043e\u0434\u0430\u043c"}),children:'\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043e \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u0445\u0430\u043a\u0430\u0442\u043e\u043d\u0430 "\u0424\u0438\u043d\u0430\u043b \u0412\u0435\u0437\u0434\u0435\u043a\u043e\u0434\u0430 2021"'})})})},v=function(e){var t=e.id,n=e.go,c=(e.fetchedUser,e.codeList),r=e.setCodeList;return Object(x.jsxs)(u.i,{id:t,children:[Object(x.jsx)(u.j,{left:Object(x.jsx)(u.k,{onClick:n,"data-to":"Home"}),children:"\u0421\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u0434\u043e\u0432"}),Object(x.jsx)(u.f,{children:Object(x.jsx)(u.h,{children:c.map((function(e){return Object(x.jsx)(u.d,{multiline:!0,removable:!0,onRemove:function(){var t;t=e.id,console.log("onRemove id: "+t),console.log("Before: "+c),console.log("After: "+c.filter((function(e){return e.id!==t}))),r(c.filter((function(e){return e.id!==t})))},children:e.text},e.id)}))})})]})},y=n(20),S=function(e){var t=e.id,n=e.go,c=(e.fetchedUser,e.codeList),r=e.allowedList;return Object(x.jsxs)(u.i,{id:t,children:[Object(x.jsx)(u.j,{left:Object(x.jsx)(u.k,{onClick:n,"data-to":"Home",label:u.r===u.p?"\u041d\u0430\u0437\u0430\u0434":void 0}),children:"\u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043d\u044b\u0435 \u043a\u043e\u0434\u044b"}),Object(x.jsxs)(u.d,{multiline:!0,children:[" \u041a\u043e\u0434 \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043d\u044b\u043c, \u0435\u0441\u043b\u0438 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044f \u043e\u0434\u043d\u0443 \u0438\u0437 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0441\u0442\u0440\u043e\u043a: ",r.map((function(e,t){return'"'+e.text+'"'+(t===r.length-1?"":",")}))]}),Object(x.jsx)(u.o,{}),Object(x.jsx)(u.f,{header:Object(x.jsx)(u.g,{children:"\u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043d\u044b\u0435 \u043a\u043e\u0434\u044b"}),children:Object(x.jsx)(u.h,{children:function(){console.log(c),console.log(r);var e,t=[],n=Object(y.a)(c);try{for(n.s();!(e=n.n()).done;){var i=e.value;console.log("code: "+i.text),console.log("codeType: "+typeof i.text);var a,s=!1,o=Object(y.a)(r);try{for(o.s();!(a=o.n()).done;){var d=a.value;if(i.text.includes(d.text)){s=!0;break}}}catch(l){o.e(l)}finally{o.f()}s&&t.push(i)}}catch(l){n.e(l)}finally{n.f()}return t}().map((function(e){return Object(x.jsx)(u.d,{multiline:!0,children:e.text},e.id)}))})}),Object(x.jsx)(u.f,{header:Object(x.jsx)(u.g,{children:"\u041d\u0435\u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043d\u044b\u0435 \u043a\u043e\u0434\u044b"}),children:Object(x.jsx)(u.h,{children:function(){var e,t=[],n=Object(y.a)(c);try{for(n.s();!(e=n.n()).done;){var i,a=e.value,s=!1,o=Object(y.a)(r);try{for(o.s();!(i=o.n()).done;){var d=i.value;if(a.text.includes(d.text)){s=!0;break}}}catch(l){o.e(l)}finally{o.f()}s||t.push(a)}}catch(l){n.e(l)}finally{n.f()}return t}().map((function(e){return Object(x.jsx)(u.d,{multiline:!0,children:e.text},e.id)}))})})]})},k=function(){arguments.length>0&&void 0!==arguments[0]||allowedList;return function(){var e=Object(c.useState)("WelcomeScreen"),t=Object(b.a)(e,2),n=t[0],r=t[1],i=Object(c.useState)(null),a=Object(b.a)(i,2),o=a[0],f=a[1],p=Object(c.useState)(Object(x.jsx)(u.m,{size:"large"})),O=Object(b.a)(p,2),g=O[0],y=O[1],k=Object(c.useState)(null),A=Object(b.a)(k,2),L=(A[0],A[1]),K=Object(c.useState)([]),W=Object(b.a)(K,2),R=W[0],V=W[1],w=Object(c.useState)(0),C=Object(b.a)(w,2),Q=C[0],U=C[1];Object(c.useEffect)((function(){function e(){return(e=Object(l.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(null),e.next=3,s.a.send("VKWebAppGetUserInfo");case 3:t=e.sent,f(t),s.a.send("VKWebAppStorageGetKeys",{count:2,offset:0});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s.a.subscribe((function(e){var t=e.detail,n=t.type,c=t.data;if(console.log("Type: "+n+". Data: "+c),"VKWebAppUpdateConfig"===n){var r=document.createAttribute("scheme");r.value="client_light",L(r.value),document.body.attributes.setNamedItem(r)}"VKWebAppStorageGetKeysFailed"!==n&&"VKWebAppStorageGetFailed"!==n||(s.a.send("VKWebAppStorageSet",{key:"maxId",value:"0"}),s.a.send("VKWebAppStorageSet",{key:"codeList",value:JSON.stringify([])})),"VKWebAppStorageGetKeysResult"===n&&s.a.send("VKWebAppStorageGet",{keys:["maxId","codeList"]}),"VKWebAppStorageGetResult"===n&&(U(parseInt(c.keys.filter((function(e){return"maxId"===e.key})).value)),V(JSON.parse(c.keys.filter((function(e){return"codeList"===e.key})).value))),"VKWebAppOpenCodeReaderResult"===n&&(s.a.send("VKWebAppStorageSet",{key:"maxId",value:JSON.stringify(Q)}),s.a.send("VKWebAppStorageSet",{key:"codeList",value:JSON.stringify(R)}),V([].concat(Object(j.a)(R),[{text:c.code_data,id:Q}])),U(Q+1))})),function(){e.apply(this,arguments)}()}),[]);var I=function(e){r(e.currentTarget.dataset.to)};return Object(x.jsx)(u.a,{children:Object(x.jsx)(u.b,{children:Object(x.jsxs)(u.q,{activePanel:n,popout:g,children:[Object(x.jsx)(m,{id:"WelcomeScreen",fetchedUser:o,go:I}),Object(x.jsx)(h,{id:"Home",fetchedUser:o,go:I,showQRReader:function(){s.a.send("VKWebAppOpenCodeReader")},codeList:R}),Object(x.jsx)(v,{id:"QrList",fetchedUser:o,go:I,codeList:R,setCodeList:V}),Object(x.jsx)(S,{id:"AllowedQrList",fetchedUser:o,go:I,codeList:R,allowedList:[{text:"test",id:4},{text:"b",id:5},{text:"123",id:6}]})]})})})}()};s.a.send("VKWebAppInit"),i.a.render(Object(x.jsx)(k,{}),document.getElementById("root"))}},[[133,1,2]]]);
//# sourceMappingURL=main.f00a4db0.chunk.js.map