{"version":3,"sources":["panels/Home.js","img/persik.png","panels/WelcomeScreen.js","panels/QRListScreen.js","panels/AllowedQRListScreen.js","App.js","index.js"],"names":["Home","id","go","showQRReader","fetchedUser","codeList","logText","getText","fake","doGet","onClick","before","data-to","expandable","indicator","mode","length","WelcomeScreen","user","icon","header","first_name","action","size","QRListScreen","setCodeList","left","map","code","multiline","removable","onRemove","i","filter","text","AllowedQRListScreen","allowedList","label","platform","VKCOM","undefined","word","index","console","log","res","b","allowedCode","includes","push","getAllowedList","getNotAllowedList","App","useState","activePanel","setActivePanel","setUser","popout","setPopout","setScheme","useEffect","a","bridge","send","then","data","data1","JSON","parse","keys","value","catch","stringify","subscribe","detail","type","schemeAttribute","document","createAttribute","body","attributes","setNamedItem","codeList1","code_data","Math","random","toString","fetchData","fn","inputs","didMountRef","useRef","current","useDidUpdateEffect","e","currentTarget","dataset","to","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.120e756b.chunk.js","sourcesContent":["import React from 'react';\n\nimport {Cell, Counter, Panel, PanelHeader, Separator} from '@vkontakte/vkui';\nimport {Icon28QrCodeOutline, Icon28ScanViewfinderOutline, Icon28StarsCircleFillViolet} from \"@vkontakte/icons\";\n\nconst Home = ({id, go, fetchedUser, showQRReader, codeList, logText, getText, fake, doGet}) => {\n    return <Panel id={id}>\n        <PanelHeader>QR приложулька1</PanelHeader>\n\n        <Cell onClick={showQRReader} before={<Icon28ScanViewfinderOutline/>}>\n            Отсканировать QR код\n        </Cell>\n\n        <Cell onClick={go} data-to='QrList' expandable before={<Icon28QrCodeOutline/>}\n              indicator={<Counter mode=\"primary\">{codeList.length}</Counter>}>\n            Список отсканированных QR кодов\n        </Cell>\n\n        <Separator/>\n\n        <Cell onClick={go} data-to='AllowedQrList' expandable before={<Icon28StarsCircleFillViolet/>}>\n            Бонусное задание\n        </Cell>\n    </Panel>\n}\n\nexport default Home;\n","export default __webpack_public_path__ + \"static/media/persik.ae9f0072.png\";","import React from \"react\";\r\nimport {Button, Group, Panel, PanelHeader, PanelHeaderBack, Placeholder} from \"@vkontakte/vkui\";\r\nimport persik from \"../img/persik.png\";\r\nimport {Icon56UsersOutline} from \"@vkontakte/icons\";\r\n\r\nconst WelcomeScreen = ({id, fetchedUser, go}) => {\r\n    const getName = (user) => {\r\n        if (user == null || user.first_name == null)\r\n            return \"Приятель\"\r\n        return fetchedUser.first_name\r\n    }\r\n\r\n    return (\r\n        <Panel id={id}>\r\n            {/*<PanelHeader right={<Avatar size={36} />}>Panel 1</PanelHeader>*/}\r\n            <Group>\r\n                <Placeholder\r\n                    icon={<Icon56UsersOutline />}\r\n                    header={\"Приветствуем, \" + getName(fetchedUser) + \"!\"}\r\n                    action={<Button size=\"m\" onClick={go} data-to=\"Home\">Перейти к QR кодам</Button>}\r\n                >\r\n                    Приложение разработано в рамках финала хакатона.\r\n                </Placeholder>\r\n            </Group>\r\n        </Panel>\r\n    )\r\n}\r\n\r\nexport default WelcomeScreen;","import React from 'react';\n\nimport {\n    Cell,\n    Group,\n    List,\n    Panel,\n    PanelHeader,\n    PanelHeaderBack,\n    PanelHeaderClose,\n    platform,\n    VKCOM\n} from '@vkontakte/vkui';\n\nconst QRListScreen = ({id, go, fetchedUser, codeList, setCodeList}) => {\n    const onRemove = (i) => {\n        setCodeList(codeList.filter((code) => code.id !== i))\n    }\n\n    return <Panel id={id}>\n        <PanelHeader\n            left={<PanelHeaderBack onClick={go} data-to={'Home'}/>}\n        >Список кодов</PanelHeader>\n        <Group>\n            <List>\n                {codeList.map((code) =>\n                    <Cell multiline key={code.id}\n                          removable onRemove={() => {onRemove(code.id)}}\n                    >\n                        {code.text}\n                    </Cell>\n                )}\n            </List>\n        </Group>\n    </Panel>\n}\n\nexport default QRListScreen;\n","import React from 'react';\n\nimport {Cell, Group, Header, List, Panel, PanelHeader, PanelHeaderBack, platform, Text, VKCOM} from '@vkontakte/vkui';\n\nconst AllowedQRListScreen = ({id, go, fetchedUser, codeList, allowedList}) => {\n    const getAllowedList = () => {\n        console.log(codeList)\n        console.log(allowedList)\n        let res = []\n        for (let code of codeList) {\n            console.log(\"code: \" + code.text)\n            console.log(\"codeType: \" + typeof (code.text))\n            let b = false\n            for (let allowedCode of allowedList) {\n                if (code.text.includes(allowedCode.text)) {\n                    b = true\n                    break\n                }\n            }\n            if (b) {\n                res.push(code)\n            }\n        }\n        return res\n    }\n\n    const getNotAllowedList = () => {\n        let res = []\n        for (let code of codeList) {\n            let b = false\n            for (let allowedCode of allowedList) {\n                if (code.text.includes(allowedCode.text)) {\n                    b = true\n                    break\n                }\n            }\n            if (!b) {\n                res.push(code)\n            }\n        }\n        return res\n    }\n\n    const getAllowedFormat = () => {\n        return allowedList.map((word, index) => \"\\\"\" + word.text + \"\\\"\" + (index === allowedList.length - 1 ? \"\" : \", \"))\n    }\n\n    return <Panel id={id}>\n        <PanelHeader\n            left={<PanelHeaderBack onClick={go} data-to={'Home'} label={platform === VKCOM ? 'Назад' : undefined}/>}\n        >Разрешенные коды</PanelHeader>\n        <Cell multiline> Код считается разрешенным, если включает в себя одну из следующий\n            строк: {getAllowedFormat()}</Cell>\n        <Text>\n        </Text>\n        <Group header={<Header>Разрешенные коды</Header>}>\n            <List>\n                {getAllowedList().map((code) =>\n                    <Cell multiline key={code.id}>{code.text}</Cell>\n                )}\n            </List>\n        </Group>\n        <Group header={<Header>Неразрешенные коды</Header>}>\n            <List>\n                {getNotAllowedList().map((code) =>\n                    <Cell multiline key={code.id}>{code.text}</Cell>\n                )}\n            </List>\n        </Group>\n    </Panel>\n}\n\nexport default AllowedQRListScreen;\n","import React, {useEffect, useRef, useState} from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport {AdaptivityProvider, AppRoot, ScreenSpinner, View} from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\n\nimport Home from './panels/Home';\nimport WelcomeScreen from \"./panels/WelcomeScreen\";\nimport QRListScreen from \"./panels/QRListScreen\";\nimport AllowedQRListScreen from \"./panels/AllowedQRListScreen\";\n\nconst App = (allowedList1 = allowedList) => {\n    const [activePanel, setActivePanel] = useState('WelcomeScreen');\n    const [fetchedUser, setUser] = useState(null);\n    const [popout, setPopout] = useState(<ScreenSpinner size='large'/>);\n    const [scheme, setScheme] = useState(null)\n    const [codeList, setCodeList] = useState([])\n    const [logText, setLogText] = useState(\"\")\n    const [getText, setGetText] = useState(\"\")\n\n    const allowedList = [{text: \".org\", id: 4}, {text: \".ru\", id: 5}, {text: \"aa\", id: 6}]\n\n    useEffect(() => {\n        bridge.subscribe(({detail: {type, data}}) => {\n            if (type === 'VKWebAppUpdateConfig') {\n                const schemeAttribute = document.createAttribute('scheme')\n                // schemeAttribute.value = data.scheme ? data.scheme : 'client_light';\n                schemeAttribute.value = 'client_light';\n                setScheme(schemeAttribute.value)\n                document.body.attributes.setNamedItem(schemeAttribute);\n            }\n\n            if (type === 'VKWebAppOpenCodeReaderResult') {\n                setCodeList(codeList1 => [...codeList1, {text: data.code_data, id: Math.random().toString()}])\n            }\n        });\n\n        async function fetchData() {\n            setPopout(null);\n            const user = await bridge.send('VKWebAppGetUserInfo');\n            setUser(user);\n            bridge.send(\"VKWebAppStorageGetKeys\", {\"count\": 1, \"offset\": 0}).then(data => {\n                bridge.send(\"VKWebAppStorageGet\", {\"keys\": [\"codeList\"]}).then(data1 => {\n                    setCodeList(JSON.parse(data1.keys[0].value))\n                });\n            }).catch(() => {\n                bridge.send(\"VKWebAppStorageSet\", {\"key\": \"codeList\", \"value\": JSON.stringify([])});\n            })\n        }\n\n        fetchData();\n    }, []);\n\n    function useDidUpdateEffect(fn, inputs) {\n        const didMountRef = useRef(false);\n\n        useEffect(() => {\n            if (didMountRef.current)\n                fn();\n            else\n                didMountRef.current = true;\n        }, inputs);\n    }\n\n    useDidUpdateEffect(() => {\n        bridge.send(\"VKWebAppStorageSet\", {\n            \"key\": \"codeList\",\n            \"value\": JSON.stringify(codeList)\n        });\n    }, [codeList])\n\n    const fake = () => {\n        // setCodeList([...codeList, {text: \"ASD\", id: Math.random().toString()}])\n    }\n\n    const doGet = () => {\n        // bridge.send(\"VKWebAppStorageGet\", {\"keys\": [\"codeList\"]}).then(data => {\n        //     setGetText(JSON.stringify(data))\n        // });\n    }\n\n    const go = e => {\n        setActivePanel(e.currentTarget.dataset.to);\n    };\n\n    const showQRReader = () => {\n        bridge.send(\"VKWebAppOpenCodeReader\")\n    }\n\n    return (\n        <AdaptivityProvider>\n            <AppRoot>\n                <View activePanel={activePanel} popout={popout}>\n                    <WelcomeScreen id='WelcomeScreen' fetchedUser={fetchedUser} go={go}/>\n                    <Home id='Home'\n                          fetchedUser={fetchedUser} go={go} showQRReader={showQRReader}\n                          codeList={codeList}\n                          logText={logText}\n                          getText={getText}\n                          fake={fake}\n                          doGet={doGet}\n                    />\n                    <QRListScreen id='QrList' fetchedUser={fetchedUser} go={go}\n                                  codeList={codeList}\n                                  setCodeList={setCodeList}/>\n                    <AllowedQRListScreen id='AllowedQrList'\n                                         fetchedUser={fetchedUser}\n                                         go={go}\n                                         codeList={codeList}\n                                         allowedList={allowedList}/>\n                </View>\n            </AppRoot>\n        </AdaptivityProvider>\n    );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport App from \"./App\";\n\n// Init VK  Mini App\nbridge.send(\"VKWebAppInit\");\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\nif (process.env.NODE_ENV === \"development\") {\n  import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\n}\n"],"sourceRoot":""}